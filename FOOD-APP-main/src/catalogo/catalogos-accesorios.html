<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/FOOD-APP-main/src/catalogo/catalogo.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <title>Pichichus Forrajeria</title>
    <style>
      
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
        }
        .navbar-brand {
            white-space: nowrap;
        }
        .small-font {
            font-size: 0.90rem;
        }

        .search-container {
            position: sticky;
            top: 0;
            background: white;
            z-index: 1000;
            padding: 10px 0;
        }
        .catalog-container {
            max-height: calc(100vh - 70px); /* Ajusta 70px según la altura de la barra de búsqueda */
            overflow-y: auto;
            padding-top: 10px;
        }
        .product-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        .product-item {
            margin-bottom: 20px;
        }
       
        




     
    </style>
</head>
<body>
    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg bg-danger">
        <div class="container-fluid">
          <img src="/img/Mercadito.png" class=""  style="margin-left: 145px;"  width="55px" alt="">
            <!-- <a class="navbar-brand text-light d-flex small-font" href="https://mercadito-appp.netlify.app/" target="_blank">¡Quiero un mercadito!</a> -->
        </div>
    </nav>


    <div class="search-container">
        <a href="/index.html " class="text-decoration-none p-2" style="color: black;" >
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-arrow-left"><circle cx="12" cy="12" r="10"/><path d="M16 12H8"/><path d="m12 8-4 4 4 4"/></svg>
    
        </a>
        <input type="text" class="search-input" id="buscador" placeholder="Buscar...">
        <button class="search-btn m-2">Buscar</button>
    </div>

    <!-- Catálogo de productos -->
    <div class="container d-flex justify-content-center align-items-center" id="catalogo">
        <div class="form-container row">
            <form class="formulario">
                <!-- Contenedor de productos con scroll -->
                <div class="product-list item-list-grid" id="formulario-catalogo">
                    <!-- PERROS -->
                    <div class="product-item">
                        <span>Estampa(4)</span>
                        <li class="list-group-item mb-4">
                           
                            
                            <div class="d-flex align-items-center mt-1 producto">
                                <img src="/img/piedritas sanitarias cat way.jpg" width="100" height="auto" class="me-2">
                                <label class="form-check-label">LIMPCAT-LAVANDA X 4KG
                                    <button type="button" class="btn btn-danger mt-1" style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;" onclick="addProduct('LIMPCAT-LAVANDA X 4KG', 600)">+</button>
                                    <button type="button" class="btn btn-danger mt-1" style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;" onclick="removeProduct('LIMPCAT-LAVANDA X 4KG', 600)">-</button>
                                </label>
                            </div>
                        </li>
                    </div>
    
                    <!-- GATOS -->
                    <div class="product-item">
                        <span></span>
                        <li class="list-group-item mb-4">
                           
                          
                        </li>
                    </div>
                    
                    <div class="product-item">
                        <span id="text-pequeño">Gran Campeon(2)</span>
                        <li class="list-group-item mb-4 ">
                            <div class="d-flex align-items-center  producto">
                                <img src="/img/piedritas.jpg" width="100" height="100%" class="me-2" alt="">
                                <label class="form-check-label">
                                    <button type="button" class="btn btn-danger mt-1" style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;" onclick="addProduct('PERRO ADULTOS', 800)">+</button>
                                    <button type="button" class="btn btn-danger mt-1" style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;" onclick="removeProduct('PERRO ADULTOS', 800)">-</button>
                                </label>
                            </div>  
                            <div class="d-flex align-items-center mt-1 producto">
                                <img src="/img/piedritas sanitarias cat way.jpg" width="100" height="100%" class="me-2" alt="">
                                <label class="form-check-label">
                                    <button type="button" class="btn btn-danger mt-1" style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;" onclick="addProduct('CACHORRO', 900)">+</button>
                                    <button type="button" class="btn btn-danger mt-1" style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;" onclick="removeProduct('CACHORRO', 900)">-</button>
                                </label>
                            </div>
                            
                        </li>
                    </div>
                </div>
    
                <!-- Botón fijo para carrito -->
                <div class="fixed-bottom bg-light p-3" id="carrito-info">
                    <button type="button" class="btn btn-primary w-100" id="boton-carrito" onclick="openModal()">Carrito (0)</button>
                </div>
    
                <!-- Banner del precio total -->
                <div class="total-price-banner">
                    <h5>Total: $<span id="total-price">0</span></h5>
                </div>
            </form>
        </div>
    </div>
    
    </div>

    <!-- Modal de carrito -->
    <div class="modal fade" id="carritoModal" tabindex="-1" aria-labelledby="carritoModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <div >
                        <h6 class="fw-bold" id="total-price-banner">TOTAL: $0</h6>
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
               
                <div class="modal-body">
                    <p id="carrito-detalles">No has agregado productos.</p>
                </div>
               
                <div class="modal-footer">
                    
                   
                    <a onclick="finalizarCompra()">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Finalizar</button>
                    </a>
                    
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      

      document.addEventListener("DOMContentLoaded", function() {
    let cart = [];
    let productDetails = '';

    function addProduct(name, price) {
        const product = cart.find(item => item.name === name);
        if (product) {
            product.quantity++;
        } else {
            cart.push({ name, price, quantity: 1 });
        }
        updateCart();
    }

    function removeProduct(name) {
        const productIndex = cart.findIndex(item => item.name === name);
        if (productIndex !== -1) {
            const product = cart[productIndex];
            product.quantity--;
            if (product.quantity === 0) {
                cart.splice(productIndex, 1);
            }
            updateCart();
        }
    }

    function updateCart() {
        const botonCarrito = document.getElementById('carrito-info').querySelector('button');
        const totalItems = cart.reduce((total, product) => total + product.quantity, 0);
        botonCarrito.textContent = `Carrito (${totalItems})`;
        updateTotalPrice();
    }

   

    function updateTotalPrice() {
    productDetails = ''; // Reinicia la variable para evitar duplicados

    const totalPrice = cart.reduce((total, product) => {
        // Agrega la cantidad y el precio al productDetails
        productDetails += `${product.name}: $${product.price.toFixed(2)} x ${product.quantity} unidades\n`;
        return total + (product.price * product.quantity);
    }, 0);

    console.log('Total Price:', totalPrice, productDetails); // Para debugging
    document.getElementById('total-price').textContent = `$${totalPrice.toFixed(2)}`;
    localStorage.setItem('totalPrice', totalPrice);
    return totalPrice;
}
    function openModal() {
        const carritoDetalles = document.getElementById('carrito-detalles');
        carritoDetalles.innerHTML = cart.length > 0
            ? cart.map(product => `${product.name}: ${product.quantity} unidades.`).join('<br>')
            : 'No has agregado productos.';

        const totalPriceElement = document.getElementById('total-price-banner');
        totalPriceElement.textContent = `TOTAL: $${updateTotalPrice()}`;
        
        const modal = new bootstrap.Modal(document.getElementById('carritoModal'));
        modal.show();
    }

    function finalizarCompra() {
    const totalPrice = updateTotalPrice();
    localStorage.setItem('totalPrice', totalPrice);
    localStorage.setItem('productDetails', productDetails.trim()); // Guarda el productDetails
    window.location.href = "/FOOD-APP-main/src/opciones-pago/pagos.html";
}
    // Exponer funciones globalmente para que los botones puedan llamarlas
    window.addProduct = addProduct;
    window.removeProduct = removeProduct;
    window.openModal = openModal;
    window.finalizarCompra = finalizarCompra; // Asegúrate de exponer finalizarCompra
});


    </script>
</body>
</html>
